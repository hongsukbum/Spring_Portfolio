<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace = "com.portfolio.spring.dao.ProductDao">
	
	<insert id = "insertNewProduct" parameterType = "com.portfolio.spring.dto.ProductDto">
		INSERT INTO PRODUCT(PD_NAME, PD_TITLE, PD_CONTENT, PD_IMAGE_PATH, PD_IMAGE, PD_CHARGE, PD_COUNT, PD_PDC_IDX, PD_PDCS_IDX) VALUES(#{pd_name},#{pd_title},#{pd_content}, #{pd_image_path} ,#{pd_image},#{pd_charge},#{pd_count}, #{pd_pdc_idx}, #{pd_pdcs_idx})
	</insert>
	
	<select id="productTotalCnt" resultType = "java.lang.Integer">
		SELECT COUNT(*) FROM PRODUCT
	</select>
	
	<select id="productSearchTotalCnt" resultType = "java.lang.Integer">
		SELECT COUNT(*) FROM PRODUCT WHERE (PD_NAME LIKE CONCAT('%',#{param1},'%') OR PD_TITLE LIKE CONCAT('%',#{param1},'%'))
	</select>
	
	<select id="productFirstIdx" resultType = "java.lang.Integer">
		SELECT PD_IDX FROM PRODUCT LIMIT 1
	</select>
	
	<select id="productSearhcFirstIdx" resultType = "java.lang.Integer">
		SELECT PD_IDX FROM PRODUCT WHERE (PD_NAME LIKE CONCAT('%',#{param1},'%') OR PD_TITLE LIKE CONCAT('%',#{param1},'%')) LIMIT 1
	</select>
	
	<select id = "productList" resultType = "com.portfolio.spring.dto.ProductDto">
		SELECT * FROM PRODUCT WHERE PD_IDX LIMIT #{param1}, #{param2} <!-- BETWEEN #{param1} AND #{param2} -->
	</select>
	
	<select id = "productSearchList" resultType = "com.portfolio.spring.dto.ProductDto">
		SELECT * FROM PRODUCT WHERE (PD_NAME LIKE CONCAT('%',#{param3},'%') OR PD_TITLE LIKE CONCAT('%',#{param3},'%')) AND PD_IDX LIMIT #{param1}, #{param2}
	</select>
	
	<select id="productDetail" resultType = "com.portfolio.spring.dto.ProductDto">
		SELECT * FROM PRODUCT WHERE PD_IDX = #{param1} 
	</select>
	
	<delete id="productDelete">
		DELETE FROM PRODUCT WHERE PD_IDX = #{param1}
	</delete>
	
</mapper>